<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TiinySwatch – Professional Color Picking, Reimagined</title>
  <meta name="description" content="A lightweight system tray color picker with 14+ color spaces, palette management, and advanced color science tools.">
  <link rel="icon" href="TiinySwatch.ico" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent-h: 220;
      --accent-s: 65%;
      --accent-l: 52%;
      --bg: #f8f8fc;
      --surface: #ffffff;
      --border: rgba(0,0,0,0.08);
      --text: #1a1a2e;
      --text-muted: #6b6b82;
      --mono: 'SF Mono','Fira Code','Cascadia Code',monospace;
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      font-family:'Inter',system-ui,-apple-system,sans-serif;
      background:var(--bg);color:var(--text);
      line-height:1.6;overflow-x:hidden;cursor:crosshair;
    }
    a,button,input,label{cursor:pointer}
    .container{max-width:960px;margin:0 auto;padding:0 28px}

    /* ===== Cursor Indicator ===== */
    #cursor-indicator{
      position:fixed;display:flex;align-items:center;gap:8px;
      padding:5px 11px 5px 5px;
      background:#fff;
      box-shadow:0 2px 16px rgba(0,0,0,0.10),0 0 0 1px rgba(0,0,0,0.05);
      border-radius:9px;pointer-events:none;z-index:10000;
      opacity:0;transition:opacity 0.08s;
      font-family:var(--mono);font-size:11.5px;color:#555;
    }
    #cursor-indicator.visible{opacity:1}
    .indicator-swatch{
      width:20px;height:20px;border-radius:5px;flex-shrink:0;
      border:1px solid rgba(0,0,0,0.10);
      transition:background 0.05s;
    }

    /* ===== Nav ===== */
    nav{
      position:fixed;top:0;left:0;right:0;z-index:1000;
      background:rgba(248,248,252,0.85);backdrop-filter:blur(16px);
      -webkit-backdrop-filter:blur(16px);
      border-bottom:1px solid var(--border);
    }
    .nav-inner{
      max-width:960px;margin:0 auto;padding:0 28px;height:54px;
      display:flex;align-items:center;justify-content:space-between;
    }
    .logo{font-weight:700;font-size:1.05rem;color:var(--text);text-decoration:none;letter-spacing:-0.02em}
    .logo span{color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));transition:color 0.35s}
    .nav-dl{
      padding:7px 18px;
      background:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      color:#fff;text-decoration:none;border-radius:8px;
      font-weight:600;font-size:0.85rem;transition:all 0.3s;
    }
    .nav-dl:hover{transform:translateY(-1px);box-shadow:0 4px 16px hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.3)}
    .nav-links{display:flex;align-items:center;gap:10px}
    .nav-coffee{
      color:var(--text-muted);text-decoration:none;font-size:0.85rem;font-weight:500;
      transition:color 0.3s;
    }
    .nav-coffee:hover{color:hsl(var(--accent-h),var(--accent-s),var(--accent-l))}

    /* ===== Hero ===== */
    #hero{
      position:relative;min-height:100vh;
      display:flex;align-items:center;justify-content:center;
      text-align:center;overflow:hidden;padding-top:54px;
    }
    #hero::before{
      content:'';position:absolute;inset:0;pointer-events:none;
      background:
        radial-gradient(ellipse at 25% 40%,hsla(var(--accent-h),55%,88%,0.4) 0%,transparent 55%),
        radial-gradient(ellipse at 75% 60%,hsla(calc(var(--accent-h)+130),55%,88%,0.3) 0%,transparent 55%);
      transition:background 0.7s;
    }
    .hero-content{position:relative;z-index:1}
    .hero-content h1{
      font-size:clamp(2.8rem,6vw,4.2rem);font-weight:800;
      letter-spacing:-0.03em;line-height:1.1;margin-bottom:14px;
    }
    .hero-content h1 span{color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));transition:color 0.35s}
    .hero-sub{
      font-size:clamp(1rem,2vw,1.15rem);color:var(--text-muted);
      max-width:500px;margin:0 auto 30px;font-weight:400;
    }
    .hero-buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}

    /* ===== Buttons ===== */
    .btn{
      display:inline-flex;align-items:center;gap:8px;
      padding:12px 28px;border-radius:10px;font-weight:600;
      font-size:0.95rem;text-decoration:none;border:none;
      transition:all 0.3s;font-family:inherit;
    }
    .btn-primary{
      background:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      color:#fff;transition:all 0.3s,background-color 0.35s;
    }
    .btn-primary:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 24px hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.3);
    }
    .btn-secondary{
      background:var(--surface);color:var(--text);
      border:1px solid var(--border);
      box-shadow:0 1px 3px rgba(0,0,0,0.04);
    }
    .btn-secondary:hover{
      border-color:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.4);
      color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
    }
    .btn-lg{padding:15px 38px;font-size:1.05rem;border-radius:12px}

    /* ===== Steps ===== */
    .step{padding:70px 0;position:relative}
    .step-header{margin-bottom:28px}
    .step-num{
      display:inline-flex;align-items:center;justify-content:center;
      width:32px;height:32px;border-radius:9px;
      background:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.10);
      color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      font-weight:700;font-size:0.85rem;margin-bottom:12px;
      transition:all 0.35s;
    }
    .step-header h2{font-size:1.7rem;font-weight:700;letter-spacing:-0.02em;margin-bottom:6px}
    .step-header p{color:var(--text-muted);font-size:0.92rem;max-width:480px}

    /* ===== Step 1: Playground ===== */
    .playground-wrap{
      position:relative;width:100%;height:620px;
    }
    #playground-canvas{width:100%;height:100%;display:block}
    .blob-labels{position:absolute;inset:0;pointer-events:none}
    .blob-label{
      position:absolute;transform:translate(-50%,-50%);
      text-align:center;pointer-events:auto;
    }
    .blob-label-name{
      font-size:1.1rem;font-weight:700;color:#fff;
      letter-spacing:0.01em;margin-bottom:3px;
    }
    .blob-label-fact{
      font-size:0.78rem;color:rgba(255,255,255,0.88);
      max-width:150px;line-height:1.35;
    }
    .playground-hint{
      margin-top:14px;text-align:center;
      font-size:0.82rem;color:var(--text-muted);
    }

    /* ===== Step 2: Adjust ===== */
    .adjust-layout{
      display:grid;grid-template-columns:auto 1fr;
      gap:36px;align-items:start;
    }
    .preview-col{text-align:center}
    #color-preview{
      width:130px;height:130px;border-radius:16px;
      transition:background 0.2s;
      box-shadow:0 2px 12px rgba(0,0,0,0.08);
      border:1px solid rgba(0,0,0,0.06);
    }
    #hex-display{
      display:block;margin-top:10px;font-family:var(--mono);
      font-size:1rem;font-weight:600;letter-spacing:0.02em;
      transition:color 0.3s;
    }
    .controls-col{min-width:0}
    .slider-row{
      display:grid;grid-template-columns:86px 1fr 44px;
      align-items:center;gap:12px;margin-bottom:14px;
    }
    .slider-row label{font-size:0.84rem;font-weight:500;color:var(--text-muted)}
    .slider-row span{font-family:var(--mono);font-size:0.8rem;color:var(--text-muted);text-align:right}
    input[type="range"]{
      -webkit-appearance:none;appearance:none;width:100%;height:10px;
      border-radius:5px;outline:none;background:#ddd;cursor:pointer;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;width:22px;height:22px;border-radius:50%;
      background:#fff;border:2px solid hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      box-shadow:0 1px 5px rgba(0,0,0,0.15);cursor:grab;transition:border-color 0.3s;
    }
    input[type="range"]::-moz-range-thumb{
      width:22px;height:22px;border-radius:50%;background:#fff;border:none;
      box-shadow:0 1px 5px rgba(0,0,0,0.15);cursor:grab;
    }
    input[type="range"]::-moz-range-track{height:10px;border-radius:5px;background:inherit}
    .hue-track{
      background:linear-gradient(to right,
        hsl(0,85%,58%),hsl(60,85%,50%),hsl(120,85%,42%),
        hsl(180,85%,45%),hsl(240,85%,58%),hsl(300,85%,55%),hsl(360,85%,58%))!important;
    }
    .format-grid{
      display:grid;grid-template-columns:repeat(3,1fr);gap:10px;
      margin-top:20px;padding-top:18px;border-top:1px solid var(--border);
    }
    .format-item{
      background:var(--bg);border:1px solid var(--border);
      border-radius:9px;padding:9px 11px;
    }
    .format-label{
      display:block;font-size:0.68rem;font-weight:600;
      color:var(--text-muted);text-transform:uppercase;
      letter-spacing:0.06em;margin-bottom:3px;
    }
    .format-val{font-family:var(--mono);font-size:0.8rem;color:var(--text)}

    /* ===== Step 3: Create ===== */
    .harmony-btns{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:22px}
    .harmony-btn{
      padding:8px 17px;border-radius:8px;border:1px solid var(--border);
      background:var(--surface);color:var(--text-muted);
      font-family:inherit;font-size:0.84rem;font-weight:500;
      transition:all 0.25s;box-shadow:0 1px 2px rgba(0,0,0,0.03);
    }
    .harmony-btn:hover{border-color:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.35);color:var(--text)}
    .harmony-btn.active{
      background:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.10);
      border-color:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.30);
      color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      transition:all 0.25s,background 0.35s,border-color 0.35s,color 0.35s;
    }
    .palette-row{display:flex;gap:12px}
    .palette-swatch{
      flex:1;min-height:110px;border-radius:14px;
      display:flex;align-items:flex-end;justify-content:center;
      padding-bottom:12px;transition:transform 0.2s;cursor:pointer;
      position:relative;overflow:hidden;
      box-shadow:0 2px 10px rgba(0,0,0,0.08);
    }
    .palette-swatch::after{
      content:'';position:absolute;inset:0;
      background:linear-gradient(to top,rgba(0,0,0,0.30) 0%,transparent 55%);
      border-radius:14px;pointer-events:none;
    }
    .palette-swatch span{
      position:relative;z-index:1;font-family:var(--mono);
      font-size:0.74rem;color:rgba(255,255,255,0.92);font-weight:500;
    }
    .palette-swatch:hover{transform:translateY(-4px)}
    .palette-swatch.base-color{box-shadow:inset 0 0 0 2px rgba(255,255,255,0.3),0 2px 10px rgba(0,0,0,0.08)}

    /* ===== Features ===== */
    #features{padding:50px 0 70px}
    #features h2{font-size:1.7rem;font-weight:700;letter-spacing:-0.02em;margin-bottom:30px}
    .feature-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    .feature-card{
      background:var(--surface);border:1px solid var(--border);
      border-radius:14px;padding:24px;
      transition:all 0.3s;box-shadow:0 1px 3px rgba(0,0,0,0.03);
    }
    .feature-card:hover{
      border-color:hsla(var(--accent-h),var(--accent-s),var(--accent-l),0.25);
      transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,0.06);
    }
    .feature-dot{width:28px;height:3px;border-radius:2px;margin-bottom:14px;transition:background 0.35s;padding:4px 0;background-clip:content-box}
    .feature-card h3{font-size:0.95rem;font-weight:600;margin-bottom:5px}
    .feature-card p{font-size:0.85rem;color:var(--text-muted);line-height:1.5}

    /* ===== CTA ===== */
    #cta{text-align:center;padding:70px 0 50px}
    #cta h2{font-size:clamp(1.7rem,4vw,2.4rem);font-weight:700;letter-spacing:-0.02em;margin-bottom:22px}
    .cta-buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    .cta-meta{margin-top:14px;color:var(--text-muted);font-size:0.86rem}
    .gh-link{
      display:inline-block;margin-top:12px;
      color:hsl(var(--accent-h),var(--accent-s),var(--accent-l));
      text-decoration:none;font-weight:500;font-size:0.92rem;transition:all 0.3s;
    }
    .gh-link:hover{text-decoration:underline}

    /* ===== Footer ===== */
    footer{padding:24px 0;border-top:1px solid var(--border)}
    footer .container{
      display:flex;justify-content:space-between;align-items:center;
      font-size:0.8rem;color:var(--text-muted);
    }
    footer a{color:var(--text-muted);text-decoration:none;transition:color 0.3s}
    footer a:hover{color:var(--text)}

    /* ===== Scroll Reveal ===== */
    .reveal{opacity:0;transform:translateY(24px);transition:opacity 0.6s ease,transform 0.6s ease}
    .reveal.visible{opacity:1;transform:translateY(0)}

    /* ===== Responsive ===== */
    @media(max-width:768px){
      .adjust-layout{grid-template-columns:1fr;gap:20px}
      .preview-col{display:flex;align-items:center;gap:14px;text-align:left}
      #color-preview{width:72px;height:72px;border-radius:13px}
      .feature-grid{grid-template-columns:repeat(2,1fr)}
      .palette-row{flex-wrap:wrap}
      .palette-swatch{min-width:calc(33% - 8px)}
      .playground-wrap{height:480px}
      .step{padding:50px 0}
    }
    @media(max-width:480px){
      .feature-grid{grid-template-columns:1fr}
      .slider-row{grid-template-columns:68px 1fr 38px;gap:8px}
      .palette-swatch{min-width:calc(50% - 6px)}
      .playground-wrap{height:360px}
    }
    @media(hover:none){
      #cursor-indicator{display:none}
    }
  </style>
</head>
<body>
  <div id="cursor-indicator">
    <div class="indicator-swatch"></div>
    <span class="indicator-hex">#F8F8FC</span>
  </div>

  <nav>
    <div class="nav-inner">
      <a href="#" class="logo">Tiiny<span>Swatch</span></a>
      <div class="nav-links">
        <a href="https://buymeacoffee.com/connorheyz" class="nav-coffee" target="_blank" rel="noopener">Buy me a coffee</a>
        <a href="https://github.com/connorheyz/TiinySwatch/releases/download/v1.0.1/TiinySwatch-1.0.1-setup.exe" class="nav-dl">Download</a>
      </div>
    </div>
  </nav>

  <section id="hero">
    <div class="hero-content">
      <h1>Tiiny<span>Swatch</span></h1>
      <p class="hero-sub">A lightweight system tray color picker with 14+ color spaces, geometric color tools, and intelligent palette creation.</p>
      <div class="hero-buttons">
        <a href="https://github.com/connorheyz/TiinySwatch/releases/download/v1.0.1/TiinySwatch-1.0.1-setup.exe" class="btn btn-primary">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 2v8m0 0l-3-3m3 3l3-3M3 13h10"/></svg>
          Download for Windows
        </a>
        <a href="https://buymeacoffee.com/connorheyz" class="btn btn-secondary" target="_blank" rel="noopener">Buy me a coffee</a>
        <a href="#pick" class="btn btn-secondary">Explore</a>
      </div>
    </div>
  </section>

  <section id="pick" class="step">
    <div class="container reveal">
      <div class="step-header">
        <div class="step-num">1</div>
        <h2>Pick a Color</h2>
      </div>
    </div>
    <div class="playground-wrap reveal" id="playground-wrap">
      <canvas id="playground-canvas"></canvas>
      <div class="blob-labels" id="blob-labels"></div>
    </div>
    <div class="container">
      <p class="playground-hint">Click to lock a color, then fine-tune below.</p>
    </div>
  </section>

  <section id="adjust" class="step">
    <div class="container reveal">
      <div class="step-header">
        <div class="step-num">2</div>
        <h2>Fine-Tune</h2>
        <p>Adjust with precision. In the app, explore 14+ color spaces including OKLab, CAM16, and ICtCp.</p>
      </div>
      <div class="adjust-layout">
        <div class="preview-col">
          <div id="color-preview"></div>
          <span id="hex-display">#4080CC</span>
        </div>
        <div class="controls-col">
          <div class="slider-row">
            <label for="hue-slider">Hue</label>
            <input type="range" id="hue-slider" min="0" max="360" value="220" class="hue-track">
            <span id="hue-val">220°</span>
          </div>
          <div class="slider-row">
            <label for="sat-slider">Saturation</label>
            <input type="range" id="sat-slider" min="0" max="100" value="65">
            <span id="sat-val">65%</span>
          </div>
          <div class="slider-row">
            <label for="lit-slider">Lightness</label>
            <input type="range" id="lit-slider" min="0" max="100" value="52">
            <span id="lit-val">52%</span>
          </div>
          <div class="format-grid">
            <div class="format-item"><span class="format-label">HEX</span><span class="format-val" id="fmt-hex">#4080CC</span></div>
            <div class="format-item"><span class="format-label">RGB</span><span class="format-val" id="fmt-rgb">64, 128, 204</span></div>
            <div class="format-item"><span class="format-label">HSL</span><span class="format-val" id="fmt-hsl">220°, 65%, 52%</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="create" class="step">
    <div class="container reveal">
      <div class="step-header">
        <div class="step-num">3</div>
        <h2>Create a Palette</h2>
        <p>Generate harmonious color combinations. In the app, export to Paint.NET, CSS gradients, and more.</p>
      </div>
      <div class="harmony-btns">
        <button class="harmony-btn active" data-harmony="complementary">Complementary</button>
        <button class="harmony-btn" data-harmony="triadic">Triadic</button>
        <button class="harmony-btn" data-harmony="tetradic">Tetradic</button>
        <button class="harmony-btn" data-harmony="analogous">Analogous</button>
        <button class="harmony-btn" data-harmony="split">Split Comp.</button>
      </div>
      <div class="palette-row" id="palette-row"></div>
    </div>
  </section>

  <section id="features">
    <div class="container reveal">
      <h2>Why TiinySwatch?</h2>
      <div class="feature-grid">
        <div class="feature-card" data-color="#48DBFB">
          <div class="feature-dot" style="background:#48DBFB"></div>
          <h3>Screen Picking</h3>
          <p>Pick colors from anywhere on your screen with a zoomed pixel view and crosshair precision.</p>
        </div>
        <div class="feature-card" data-color="#A29BFE">
          <div class="feature-dot" style="background:#A29BFE"></div>
          <h3>14+ Color Spaces</h3>
          <p>Convert between RGB, HSL, Lab, OKLab, CAM16, ICtCp, XYZ, and more in real time.</p>
        </div>
        <div class="feature-card" data-color="#2ECC71">
          <div class="feature-dot" style="background:#2ECC71"></div>
          <h3>Palette Management</h3>
          <p>Build, organize, and export palettes. Multi-select support and Paint.NET export.</p>
        </div>
        <div class="feature-card" data-color="#FFA502">
          <div class="feature-dot" style="background:#FFA502"></div>
          <h3>Pantone Matching</h3>
          <p>Find the closest Pantone color to any shade. Essential for print and brand work.</p>
        </div>
        <div class="feature-card" data-color="#00CEC9">
          <div class="feature-dot" style="background:#00CEC9"></div>
          <h3>System Tray</h3>
          <p>Lives in your system tray, always a hotkey away. Lightweight and non-intrusive.</p>
        </div>
        <div class="feature-card" data-color="#FD79A8">
          <div class="feature-dot" style="background:#FD79A8"></div>
          <h3>Color Geometry</h3>
          <p>Arc gradients, tetrahedral distributions, and geometric color tools for advanced work.</p>
        </div>
      </div>
    </div>
  </section>

  <section id="cta">
    <div class="container reveal">
      <h2>Ready to pick?</h2>
      <div class="cta-buttons">
        <a href="https://github.com/connorheyz/TiinySwatch/releases/download/v1.0.1/TiinySwatch-1.0.1-setup.exe" class="btn btn-primary btn-lg">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 2v8m0 0l-3-3m3 3l3-3M3 13h10"/></svg>
          Download for Windows
        </a>
        <a href="https://buymeacoffee.com/connorheyz" class="btn btn-secondary btn-lg" target="_blank" rel="noopener">Buy me a coffee</a>
      </div>
      <p class="cta-meta">Free &amp; Open Source &middot; v1.0.1 &middot; Windows</p>
      <a href="https://github.com/connorheyz/TiinySwatch" class="gh-link">View on GitHub &rarr;</a>
    </div>
  </section>

  <footer>
    <div class="container">
      <span>TiinySwatch &copy; 2026</span>
      <a href="https://github.com/connorheyz/TiinySwatch">GitHub</a>
    </div>
  </footer>

  <script>
    const $ = id => document.getElementById(id);

    /* ===== Color Math ===== */
    function hslToRgb(h,s,l){
      s/=100;l/=100;
      const c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs((h/60)%2-1)),m=l-c/2;
      let r,g,b;
      if(h<60){r=c;g=x;b=0}else if(h<120){r=x;g=c;b=0}
      else if(h<180){r=0;g=c;b=x}else if(h<240){r=0;g=x;b=c}
      else if(h<300){r=x;g=0;b=c}else{r=c;g=0;b=x}
      return[Math.round((r+m)*255),Math.round((g+m)*255),Math.round((b+m)*255)];
    }
    function rgbToHsl(r,g,b){
      r/=255;g/=255;b/=255;
      const max=Math.max(r,g,b),min=Math.min(r,g,b);
      let h=0,s=0,l=(max+min)/2;
      if(max!==min){
        const d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);
        switch(max){
          case r:h=((g-b)/d+(g<b?6:0))/6;break;
          case g:h=((b-r)/d+2)/6;break;
          case b:h=((r-g)/d+4)/6;break;
        }
      }
      return[Math.round(h*360),Math.round(s*100),Math.round(l*100)];
    }
    function hslToHex(h,s,l){
      const[r,g,b]=hslToRgb(h,s,l);
      return'#'+[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('').toUpperCase();
    }
    function hexToRgb(hex){
      hex=hex.replace('#','');
      return[parseInt(hex.slice(0,2),16),parseInt(hex.slice(2,4),16),parseInt(hex.slice(4,6),16)];
    }
    function hexToHsl(hex){return rgbToHsl(...hexToRgb(hex))}
    function rgbToHex(r,g,b){
      return'#'+[r,g,b].map(v=>Math.max(0,Math.min(255,v)).toString(16).padStart(2,'0')).join('').toUpperCase();
    }

    /* ===== State ===== */
    const state={h:220,s:65,l:52,harmony:'complementary'};

    function setAccent(h,s,l){
      const r=document.documentElement.style;
      r.setProperty('--accent-h',h);
      r.setProperty('--accent-s',s+'%');
      r.setProperty('--accent-l',l+'%');
    }

    function setColor(h,s,l,fromSlider){
      state.h=h;state.s=s;state.l=l;
      setAccent(h,s,l);
      if(!fromSlider){
        $('hue-slider').value=h;$('sat-slider').value=s;$('lit-slider').value=l;
        $('hue-val').textContent=h+'°';
        $('sat-val').textContent=s+'%';
        $('lit-val').textContent=l+'%';
      }
      const hex=hslToHex(h,s,l);
      const[r,g,b]=hslToRgb(h,s,l);
      $('color-preview').style.background=hex;
      $('hex-display').textContent=hex;
      $('hex-display').style.color=hex;
      $('fmt-hex').textContent=hex;
      $('fmt-rgb').textContent=`${r}, ${g}, ${b}`;
      $('fmt-hsl').textContent=`${h}°, ${s}%, ${l}%`;
      updateSliderTracks();
      updatePalette();
    }

    function updateSliderTracks(){
      const{h,s,l}=state;
      $('sat-slider').style.background=
        `linear-gradient(to right,hsl(${h},0%,${l}%),hsl(${h},100%,${l}%))`;
      $('lit-slider').style.background=
        `linear-gradient(to right,hsl(${h},${s}%,0%),hsl(${h},${s}%,50%),hsl(${h},${s}%,100%))`;
    }

    /* ===== Palette ===== */
    function harmony(h,s,l,type){
      const c=[{h,s,l}];
      const off={complementary:[180],triadic:[120,240],tetradic:[90,180,270],analogous:[-30,30],split:[150,210]};
      (off[type]||[]).forEach(o=>c.push({h:(h+o+360)%360,s,l}));
      return c;
    }
    function updatePalette(){
      const colors=harmony(state.h,state.s,state.l,state.harmony);
      const row=$('palette-row');row.innerHTML='';
      colors.forEach((c,i)=>{
        const hex=hslToHex(c.h,c.s,c.l);
        const div=document.createElement('div');
        div.className='palette-swatch'+(i===0?' base-color':'');
        div.style.background=`hsl(${c.h},${c.s}%,${c.l}%)`;
        div.dataset.color=hex;
        div.innerHTML=`<span>${hex}</span>`;
        div.addEventListener('click',()=>setColor(c.h,c.s,c.l));
        row.appendChild(div);
      });
    }

    /* ===== Playground Canvas ===== */
    let pgCtx;

    function blobPath(ctx,cx,cy,r,seed){
      const pts=7,step=Math.PI*2/pts,coords=[];
      for(let i=0;i<pts;i++){
        const a=step*i+seed*0.5;
        const rv=r*(0.88+0.12*Math.sin(seed+i*2.1)+0.06*Math.cos(seed*1.7+i*3.4));
        coords.push({x:cx+Math.cos(a)*rv,y:cy+Math.sin(a)*rv});
      }
      ctx.beginPath();
      ctx.moveTo((coords[pts-1].x+coords[0].x)/2,(coords[pts-1].y+coords[0].y)/2);
      for(let i=0;i<pts;i++){
        const nx=(i+1)%pts;
        ctx.quadraticCurveTo(coords[i].x,coords[i].y,
          (coords[i].x+coords[nx].x)/2,(coords[i].y+coords[nx].y)/2);
      }
      ctx.closePath();
    }

    function drawPlayground(){
      const canvas=$('playground-canvas');
      const dpr=window.devicePixelRatio||1;
      const rect=canvas.getBoundingClientRect();
      canvas.width=rect.width*dpr;canvas.height=rect.height*dpr;
      pgCtx=canvas.getContext('2d',{willReadFrequently:true});
      pgCtx.scale(dpr,dpr);
      const w=rect.width,h=rect.height;
      pgCtx.fillStyle='#f8f8fc';
      pgCtx.fillRect(0,0,w,h);

      const layoutW=Math.min(w,1050);
      const ox=(w-layoutW)/2;
      const rScale=1+(w-layoutW)/w*0.55;

      const blobDefs=[
        {cx:0.04, cy:0.40, r:0.32, seed:1.2,
         angle:Math.PI*0.22,
         stops:[[0,'#d22828'],[0.45,'#f06437'],[1,'#ffb060']],
         name:'Vermilion',fact:'Used in ancient cave paintings over 30,000 years ago'},
        {cx:0.55, cy:0.26, r:0.28, seed:3.9,
         angle:Math.PI*1.55,
         stops:[[0,'#2237d7'],[0.5,'#4b73f0'],[1,'#87afff']],
         name:'Cobalt',fact:'Once more valuable than gold, made from crushed lapis lazuli'},
        {cx:0.40, cy:0.74, r:0.28, seed:5.4,
         angle:Math.PI*0.75,
         stops:[[0,'#0fa050'],[0.5,'#28c882'],[1,'#5adcaf']],
         name:'Emerald',fact:'The human eye can distinguish more shades of green than any other color'},
        {cx:0.96, cy:0.56, r:0.32, seed:7.8,
         angle:Math.PI*1.25,
         stops:[[0,'#9628d2'],[0.5,'#c84bc8'],[1,'#f07db9']],
         name:'Magenta',fact:'Doesn\'t exist on the visible spectrum. Your brain invents it'},
      ];

      const pts=blobDefs.map(b=>({x:ox+b.cx*layoutW,y:b.cy*h})).sort((a,b)=>a.x-b.x);
      const firstY=pts[0].y-(pts[1].y-pts[0].y)*0.6;
      const lastY=pts[pts.length-1].y-(pts[pts.length-2].y-pts[pts.length-1].y)*0.6;
      const sp=[{x:-w*0.08,y:firstY},...pts,{x:w*1.08,y:lastY}];
      pgCtx.save();
      pgCtx.setLineDash([14,12]);
      pgCtx.lineWidth=4;
      pgCtx.strokeStyle='#c8c9d0';
      pgCtx.lineCap='round';
      pgCtx.beginPath();
      pgCtx.moveTo(sp[0].x,sp[0].y);
      for(let i=1;i<sp.length;i++){
        const p0=sp[Math.max(i-2,0)],p1=sp[i-1],p2=sp[i],p3=sp[Math.min(i+1,sp.length-1)];
        const cp1x=p1.x+(p2.x-p0.x)/3,cp1y=p1.y+(p2.y-p0.y)/3;
        const cp2x=p2.x-(p3.x-p1.x)/3,cp2y=p2.y-(p3.y-p1.y)/3;
        pgCtx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,p2.x,p2.y);
      }
      pgCtx.stroke();
      pgCtx.restore();

      blobDefs.forEach(b=>{
        const cx=ox+b.cx*layoutW,cy=b.cy*h,r=b.r*h*rScale;
        pgCtx.save();
        blobPath(pgCtx,cx,cy,r,b.seed);
        pgCtx.clip();
        const dx=Math.cos(b.angle)*r, dy=Math.sin(b.angle)*r;
        const grad=pgCtx.createLinearGradient(cx-dx,cy-dy,cx+dx,cy+dy);
        b.stops.forEach(s=>grad.addColorStop(s[0],s[1]));
        pgCtx.fillStyle=grad;
        pgCtx.fillRect(0,0,w,h);
        pgCtx.restore();
      });

      const labelsEl=$('blob-labels');
      labelsEl.innerHTML='';
      blobDefs.forEach(b=>{
        const lx=ox+b.cx*layoutW, ly=b.cy*h;
        const pctX=Math.max(12,Math.min(88,lx/w*100));
        const pctY=ly/h*100;
        const el=document.createElement('div');
        el.className='blob-label';
        el.style.left=pctX+'%';
        el.style.top=pctY+'%';
        el.innerHTML='<div class="blob-label-name">'+b.name+'</div><div class="blob-label-fact">'+b.fact+'</div>';
        labelsEl.appendChild(el);
      });
    }

    function samplePlayground(cx,cy){
      const canvas=$('playground-canvas');
      const rect=canvas.getBoundingClientRect();
      const dpr=window.devicePixelRatio||1;
      const x=Math.round((cx-rect.left)*dpr);
      const y=Math.round((cy-rect.top)*dpr);
      if(x<0||y<0||x>=canvas.width||y>=canvas.height) return null;
      const d=pgCtx.getImageData(x,y,1,1).data;
      return[d[0],d[1],d[2]];
    }

    /* ===== DOM Color Sampling ===== */
    function parseRgb(str){
      const m=str.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
      return m?{r:+m[1],g:+m[2],b:+m[3],a:m[4]!==undefined?+m[4]:1}:null;
    }

    function blendOver(fg,bg){
      const a=fg.a,ia=1-a;
      return {r:Math.round(fg.r*a+bg.r*ia),g:Math.round(fg.g*a+bg.g*ia),b:Math.round(fg.b*a+bg.b*ia),a:1};
    }

    function sampleTextOnly(x,y){
      if(!document.caretRangeFromPoint&&!document.caretPositionFromPoint) return null;
      let node,offset;
      if(document.caretRangeFromPoint){
        const r=document.caretRangeFromPoint(x,y);
        if(r){node=r.startContainer;offset=r.startOffset;}
      }else{
        const p=document.caretPositionFromPoint(x,y);
        if(p){node=p.offsetNode;offset=p.offset;}
      }
      if(!node||node.nodeType!==Node.TEXT_NODE||!node.parentElement||offset>=node.length) return null;
      const r2=document.createRange();
      r2.setStart(node,offset);r2.setEnd(node,offset+1);
      const cr=r2.getBoundingClientRect();
      if(x<cr.left||x>cr.right||y<cr.top||y>cr.bottom) return null;
      const c=parseRgb(getComputedStyle(node.parentElement).color);
      if(!c||c.a<=0) return null;
      return rgbToHex(c.r,c.g,c.b);
    }

    function sampleElement(el,x,y){
      if(!el) return '#F8F8FC';
      if(document.caretRangeFromPoint||document.caretPositionFromPoint){
        let node,offset;
        if(document.caretRangeFromPoint){
          const r=document.caretRangeFromPoint(x,y);
          if(r){node=r.startContainer;offset=r.startOffset;}
        }else{
          const p=document.caretPositionFromPoint(x,y);
          if(p){node=p.offsetNode;offset=p.offset;}
        }
        if(node&&node.nodeType===Node.TEXT_NODE&&node.parentElement&&offset<node.length){
          const r2=document.createRange();
          r2.setStart(node,offset);r2.setEnd(node,offset+1);
          const charRect=r2.getBoundingClientRect();
          if(x>=charRect.left&&x<=charRect.right&&y>=charRect.top&&y<=charRect.bottom){
            const textC=parseRgb(getComputedStyle(node.parentElement).color);
            if(textC&&textC.a>0){
              if(textC.a>=0.99) return rgbToHex(textC.r,textC.g,textC.b);
              const bgHex=sampleBgStack(node.parentElement);
              const bgC=hexToRgbObj(bgHex);
              const blended=blendOver(textC,bgC);
              return rgbToHex(blended.r,blended.g,blended.b);
            }
          }
        }
      }
      return sampleBgStack(el);
    }

    function hexToRgbObj(hex){
      const r=Number.parseInt(hex.slice(1,3),16),g=Number.parseInt(hex.slice(3,5),16),b=Number.parseInt(hex.slice(5,7),16);
      return {r,g,b,a:1};
    }

    function sampleBgStack(el){
      const layers=[];
      let n=el;
      while(n&&n!==document){
        const bg=getComputedStyle(n).backgroundColor;
        if(bg&&bg!=='transparent'){
          const c=parseRgb(bg);
          if(c&&c.a>0.001){
            layers.push(c);
            if(c.a>=0.99) break;
          }
        }
        n=n.parentElement;
      }
      let result={r:248,g:248,b:252,a:1};
      for(let i=layers.length-1;i>=0;i--) result=blendOver(layers[i],result);
      return rgbToHex(result.r,result.g,result.b);
    }

    /* ===== Cursor Indicator ===== */
    function isOverPlayground(x,y){
      const c=$('playground-canvas');
      if(!c) return false;
      const r=c.getBoundingClientRect();
      return x>=r.left&&x<=r.right&&y>=r.top&&y<=r.bottom;
    }

    function initCursor(){
      const ind=$('cursor-indicator');
      const swatch=ind.querySelector('.indicator-swatch');
      const hexLabel=ind.querySelector('.indicator-hex');

      document.addEventListener('mousemove',e=>{
        const el=document.elementFromPoint(e.clientX,e.clientY);
        if(el && el.closest('a,button,input,select,textarea,label,nav')){
          ind.classList.remove('visible');
          return;
        }
        ind.classList.add('visible');
        ind.style.left=(e.clientX+14)+'px';
        ind.style.top=(e.clientY+14)+'px';

        let hex;
        const overPG=isOverPlayground(e.clientX,e.clientY);
        const onBlobLabel=el&&el.closest('.blob-label');
        if(onBlobLabel){
          const textHex=sampleTextOnly(e.clientX,e.clientY);
          const rgb=samplePlayground(e.clientX,e.clientY);
          hex=textHex||(rgb?rgbToHex(...rgb):'#EDEEF6');
          if(rgb){const[h,s,l]=rgbToHsl(...rgb);if(s>12&&l>12&&l<88) setColor(h,s,l);}
        }else if(overPG){
          const rgb=samplePlayground(e.clientX,e.clientY);
          hex=rgb?rgbToHex(...rgb):'#EDEEF6';
          const[h,s,l]=hexToHsl(hex);
          if(s>12&&l>12&&l<88) setColor(h,s,l);
        }else{
          hex=sampleElement(el,e.clientX,e.clientY);
        }
        swatch.style.background=hex;
        hexLabel.textContent=hex;
      });

      document.addEventListener('mouseleave',()=>{
        ind.classList.remove('visible');
      });
    }

    /* ===== Playground Click ===== */
    function initPlayground(){
      drawPlayground();
      window.addEventListener('resize',drawPlayground);

      const canvas=$('playground-canvas');
      document.addEventListener('click',e=>{
        if(e.target.closest('a,button,input,select,textarea,label,nav')) return;
        let hex;
        const el=document.elementFromPoint(e.clientX,e.clientY);
        const onBlobLabel=el&&el.closest('.blob-label');
        if(onBlobLabel){
          const textHex=sampleTextOnly(e.clientX,e.clientY);
          if(textHex){hex=textHex;}
          else{const rgb=samplePlayground(e.clientX,e.clientY);hex=rgb?rgbToHex(...rgb):null;}
        }else if(isOverPlayground(e.clientX,e.clientY)){
          const rgb=samplePlayground(e.clientX,e.clientY);
          hex=rgb?rgbToHex(...rgb):null;
        }else{
          hex=sampleElement(el,e.clientX,e.clientY);
        }
        if(hex){
          const[h,s,l]=hexToHsl(hex);
          setColor(h,s,l);
        }
      });
    }

    /* ===== Sliders ===== */
    function initSliders(){
      ['hue','sat','lit'].forEach(id=>{
        $(id+'-slider').addEventListener('input',()=>{
          const h=+$('hue-slider').value,s=+$('sat-slider').value,l=+$('lit-slider').value;
          $('hue-val').textContent=h+'°';
          $('sat-val').textContent=s+'%';
          $('lit-val').textContent=l+'%';
          setColor(h,s,l,true);
        });
      });
    }

    /* ===== Harmony Buttons ===== */
    function initHarmonyBtns(){
      document.querySelectorAll('.harmony-btn').forEach(btn=>{
        btn.addEventListener('click',()=>{
          document.querySelectorAll('.harmony-btn.active').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          state.harmony=btn.dataset.harmony;
          updatePalette();
        });
      });
    }

    /* ===== Feature Cards Hover ===== */
    function initFeatureCards(){
      document.querySelectorAll('.feature-card[data-color]').forEach(card=>{
        const dot=card.querySelector('.feature-dot');
        if(!dot) return;
        const[h,s,l]=hexToHsl(card.dataset.color);
        let prev;
        dot.addEventListener('mouseenter',()=>{prev={h:state.h,s:state.s,l:state.l};setColor(h,s,l);});
        dot.addEventListener('mouseleave',()=>{
          if(dot._locked) dot._locked=false;
          else if(prev) setColor(prev.h,prev.s,prev.l);
        });
        dot.addEventListener('click',e=>{e.stopPropagation();dot._locked=true;setColor(h,s,l);});
      });
    }

    /* ===== Global Click Pick ===== */
    function initGlobalPick(){
      document.addEventListener('click',e=>{
        if(e.target.closest('a,button,input,select,textarea,label,nav,.playground-wrap')) return;
        const el=e.target.closest('[data-color]');
        if(el){
          const[h,s,l]=hexToHsl(el.dataset.color);
          setColor(h,s,l);
        }
      });
    }

    /* ===== Scroll Reveal ===== */
    function initReveal(){
      const obs=new IntersectionObserver(entries=>{
        entries.forEach(e=>{if(e.isIntersecting) e.target.classList.add('visible')});
      },{threshold:0.12});
      document.querySelectorAll('.reveal').forEach(el=>obs.observe(el));
    }

    /* ===== Init ===== */
    function init(){
      setColor(state.h,state.s,state.l);
      initPlayground();
      initCursor();
      initSliders();
      initHarmonyBtns();
      initFeatureCards();
      initGlobalPick();
      initReveal();
    }
    document.addEventListener('DOMContentLoaded',init);
  </script>
</body>
</html>
